<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Lemon - Unified Plan</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            sage: { 50: '#f6f7f4', 100: '#e8ebe3', 200: '#d4dac9', 300: '#b5c0a5', 400: '#94a47f', 500: '#778a62', 600: '#5d6e4d' },
            warm: { 50: '#fefcf9', 100: '#fdf8f0', 200: '#faf0df', 300: '#f5e4c8' },
            lemon: { 50: '#fefce8', 100: '#fef9c3', 400: '#fcd34d', 500: '#fbbf24' }
          }
        }
      }
    }
  </script>
  <style>
    * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 0; background: #f5f5f0; }
    .hide-scrollbar::-webkit-scrollbar { display: none; }
    .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    @keyframes slide-up { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .slide-up { animation: slide-up 0.25s ease-out; }
    @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
    .fade-in { animation: fade-in 0.3s ease-out; }
    @keyframes check-pop { 0% { transform: scale(0); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }
    .check-pop { animation: check-pop 0.25s ease-out; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState } = React;

    // Icons
    const Icons = {
      Leaf: () => <svg viewBox="0 0 24 24" fill="currentColor" className="w-6 h-6"><path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66.95-2.3c.48.17.98.3 1.34.3C19 20 22 3 22 3c-1 2-8 2.25-13 3.25S2 11.5 2 13.5s1.75 3.75 1.75 3.75C7 8 17 8 17 8z"/></svg>,
      Sun: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="4"/><path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/></svg>,
      Flame: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg>,
      ChevronRight: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m9 18 6-6-6-6"/></svg>,
      Check: () => <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><polyline points="20 6 9 17 4 12"/></svg>,
      X: () => <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>,
      Target: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>,
      TrendingUp: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></svg>,
      Zap: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
      MessageCircle: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"/></svg>,
      Calendar: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect width="18" height="18" x="3" y="4" rx="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>,
      Sparkles: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>,
      Heart: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>,
      Dumbbell: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="m6.5 6.5 11 11M21 21l-1-1M3 3l1 1M18 22l4-4M2 6l4-4M3 10l7-7M14 21l7-7"/></svg>,
      Footprints: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 10 3.8 10 5.5c0 3.11-2 5.66-2 8.68V16a2 2 0 1 1-4 0Z"/><path d="M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 14 7.8 14 9.5c0 3.11 2 5.66 2 8.68V20a2 2 0 1 0 4 0Z"/></svg>,
      Wind: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2M9.6 4.6A2 2 0 1 1 11 8H2M12.6 19.4A2 2 0 1 0 14 16H2"/></svg>,
      Droplet: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"/></svg>,
      Moon: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>,
      Trophy: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>,
    };

    // Initial plan items (from personalized plan + user habits)
    const INITIAL_PLAN = [
      { id: 'plan-1', title: '15-min bodyweight workout', time: 'Morning', icon: 'Dumbbell', bgColor: 'bg-amber-100 text-amber-600', fromPlan: true, goalTag: 'Build Muscle' },
      { id: 'plan-2', title: 'Post-lunch walk', time: '15 min', icon: 'Footprints', bgColor: 'bg-emerald-100 text-emerald-600', fromPlan: true, goalTag: 'Energy' },
      { id: 'user-1', title: 'Morning stretch', time: '10 min', icon: 'Heart', bgColor: 'bg-rose-100 text-rose-600', fromPlan: false },
    ];

    // Browse activities
    const BROWSE_ACTIVITIES = {
      forYou: [
        { id: 'b1', title: 'Morning hydration', time: '2 min', icon: 'Droplet', gradient: 'from-cyan-400 to-blue-500' },
        { id: 'b2', title: 'Box breathing', time: '5 min', icon: 'Wind', gradient: 'from-violet-400 to-purple-500' },
        { id: 'b3', title: 'Evening wind-down', time: '10 min', icon: 'Moon', gradient: 'from-indigo-400 to-purple-500' },
      ],
      movement: [
        { id: 'b4', title: '10 min walk', time: 'Easy', icon: 'Footprints', gradient: 'from-amber-400 to-orange-500' },
        { id: 'b5', title: 'Quick stretch', time: '5 min', icon: 'Heart', gradient: 'from-rose-400 to-pink-500' },
      ],
      challenges: [
        { id: 'c1', title: 'Hydration Week', duration: '7 days', progress: 3, icon: 'Droplet', gradient: 'from-purple-500 to-indigo-600' },
        { id: 'c2', title: 'Morning Movement', duration: '14 days', progress: 0, icon: 'Dumbbell', gradient: 'from-teal-500 to-cyan-600' },
      ]
    };

    // Week calendar data
    const WEEK_DATA = [
      { day: 'S', date: 2, completed: true, isToday: false },
      { day: 'M', date: 3, completed: true, isToday: false },
      { day: 'T', date: 4, completed: true, isToday: false },
      { day: 'W', date: 5, completed: true, isToday: false },
      { day: 'T', date: 6, completed: true, isToday: false },
      { day: 'F', date: 7, completed: false, isToday: true },
      { day: 'S', date: 8, completed: false, isToday: false },
    ];

    // Contextual Nudge - Steps Progress
    function StepsNudge({ onAdd, onDismiss }) {
      const currentSteps = 3200;
      const goalSteps = 5000;
      const progress = (currentSteps / goalSteps) * 100;

      return (
        <div className="mx-5 mb-3 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-2xl p-4 border border-blue-100 slide-up">
          <div className="flex items-start gap-3">
            <div className="w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center text-blue-500 flex-shrink-0">
              <Icons.Footprints />
            </div>
            <div className="flex-1">
              <div className="flex items-center justify-between mb-1">
                <p className="font-medium text-gray-800 text-sm">You're at {currentSteps.toLocaleString()} steps</p>
                <button onClick={onDismiss} className="text-gray-400 hover:text-gray-600">
                  <Icons.X />
                </button>
              </div>
              <p className="text-xs text-gray-500 mb-2">A short walk could get you to {goalSteps.toLocaleString()}!</p>

              {/* Progress bar */}
              <div className="w-full h-2 bg-blue-100 rounded-full overflow-hidden mb-3">
                <div
                  className="h-full bg-gradient-to-r from-blue-400 to-cyan-400 rounded-full transition-all"
                  style={{ width: `${progress}%` }}
                />
              </div>

              <button
                onClick={onAdd}
                className="text-xs bg-blue-500 text-white px-3 py-1.5 rounded-lg font-medium"
              >
                Add 15-min walk
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Level Up Prompt
    function LevelUpPrompt({ onAccept, onDismiss }) {
      return (
        <div className="mx-5 mb-3 bg-gradient-to-r from-purple-50 to-violet-50 rounded-2xl p-4 border border-purple-100 slide-up">
          <div className="flex items-start gap-3">
            <div className="w-10 h-10 bg-purple-100 rounded-xl flex items-center justify-center text-purple-500 flex-shrink-0">
              <Icons.TrendingUp />
            </div>
            <div className="flex-1">
              <div className="flex items-center justify-between mb-1">
                <p className="font-medium text-gray-800 text-sm">Ready to level up? ðŸŽ‰</p>
                <button onClick={onDismiss} className="text-gray-400 hover:text-gray-600">
                  <Icons.X />
                </button>
              </div>
              <p className="text-xs text-gray-500 mb-3">You've done morning stretches for 14 days straight. Try a 15-min yoga flow?</p>

              <div className="flex gap-2">
                <button
                  onClick={onAccept}
                  className="text-xs bg-purple-500 text-white px-3 py-1.5 rounded-lg font-medium"
                >
                  Yes, level up!
                </button>
                <button
                  onClick={onDismiss}
                  className="text-xs bg-white border border-gray-200 text-gray-600 px-3 py-1.5 rounded-lg"
                >
                  Keep current
                </button>
              </div>
            </div>
          </div>
        </div>
      );
    }

    // Soft Check-in
    function SoftCheckIn({ onKeep, onSwap, onDismiss }) {
      return (
        <div className="mx-5 mb-3 bg-gradient-to-r from-amber-50 to-orange-50 rounded-2xl p-4 border border-amber-100 slide-up">
          <div className="flex items-start gap-3">
            <div className="w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center text-amber-500 flex-shrink-0">
              <Icons.MessageCircle />
            </div>
            <div className="flex-1">
              <div className="flex items-center justify-between mb-1">
                <p className="font-medium text-gray-800 text-sm">Quick check-in</p>
                <button onClick={onDismiss} className="text-gray-400 hover:text-gray-600">
                  <Icons.X />
                </button>
              </div>
              <p className="text-xs text-gray-500 mb-3">You've skipped evening wind-down the last 3 days. Want to swap it for something else?</p>

              <div className="flex gap-2">
                <button
                  onClick={onKeep}
                  className="text-xs bg-amber-500 text-white px-3 py-1.5 rounded-lg font-medium"
                >
                  Keep it
                </button>
                <button
                  onClick={onSwap}
                  className="text-xs bg-white border border-gray-200 text-gray-600 px-3 py-1.5 rounded-lg"
                >
                  Show alternatives
                </button>
              </div>
            </div>
          </div>
        </div>
      );
    }

    // Main App
    function App() {
      const [myPlan, setMyPlan] = useState(INITIAL_PLAN);
      const [completedIds, setCompletedIds] = useState(new Set());

      // Contextual notification states
      const [showStepsNudge, setShowStepsNudge] = useState(true);
      const [showLevelUp, setShowLevelUp] = useState(true);
      const [showCheckIn, setShowCheckIn] = useState(true); // Soft check-in enabled

      const removeFromPlan = (id) => {
        setMyPlan(prev => prev.filter(a => a.id !== id));
      };

      const addToPlan = (activity) => {
        // Check if already in plan
        if (myPlan.some(a => a.id === activity.id)) return;

        const newActivity = {
          id: activity.id,
          title: activity.title,
          time: activity.time,
          icon: activity.icon,
          bgColor: getBgColorFromGradient(activity.gradient),
          fromPlan: false,
        };
        setMyPlan(prev => [...prev, newActivity]);
      };

      const toggleComplete = (id) => {
        setCompletedIds(prev => {
          const newSet = new Set(prev);
          if (newSet.has(id)) {
            newSet.delete(id);
          } else {
            newSet.add(id);
          }
          return newSet;
        });
      };

      const getBgColorFromGradient = (gradient) => {
        if (gradient.includes('cyan')) return 'bg-cyan-100 text-cyan-600';
        if (gradient.includes('violet')) return 'bg-violet-100 text-violet-600';
        if (gradient.includes('indigo')) return 'bg-indigo-100 text-indigo-600';
        if (gradient.includes('amber')) return 'bg-amber-100 text-amber-600';
        if (gradient.includes('rose')) return 'bg-rose-100 text-rose-600';
        return 'bg-gray-100 text-gray-600';
      };

      const planItemIds = new Set(myPlan.map(a => a.id));
      const streakCount = WEEK_DATA.filter(d => d.completed).length;

      // Nudge handlers
      const handleAddWalk = () => {
        const walkActivity = {
          id: 'nudge-walk',
          title: '15-min walk',
          time: '15 min',
          icon: 'Footprints',
          bgColor: 'bg-blue-100 text-blue-600',
          fromPlan: false,
        };
        setMyPlan(prev => [...prev, walkActivity]);
        setShowStepsNudge(false);
      };

      const handleLevelUp = () => {
        // Replace morning stretch with yoga
        setMyPlan(prev => prev.map(a =>
          a.id === 'user-1'
            ? { ...a, title: '15-min yoga flow', time: '15 min', bgColor: 'bg-violet-100 text-violet-600' }
            : a
        ));
        setShowLevelUp(false);
      };

      return (
        <div className="min-h-screen bg-warm-50 max-w-md mx-auto pb-8">
          {/* Header */}
          <div className="bg-gradient-to-b from-sage-50 to-warm-50 px-5 pt-12 pb-4">
            <div className="flex items-center justify-between mb-4">
              <div className="flex items-center gap-2">
                <span className="text-sage-500"><Icons.Leaf /></span>
                <span className="text-lg font-semibold text-sage-600">Lemon</span>
              </div>
            </div>
            <div className="text-center pb-2">
              <p className="text-sage-500 text-sm mb-1">Good morning</p>
              <h1 className="text-2xl font-semibold text-gray-800">Maiu</h1>
            </div>
          </div>

          {/* Week Calendar */}
          <div className="bg-white rounded-2xl border border-gray-100 p-4 mx-5 mb-4">
            <div className="flex items-center justify-between mb-4">
              <div className="flex items-center gap-2">
                <span className="text-sage-500"><Icons.Calendar /></span>
                <span className="text-sm font-medium text-gray-700">This Week</span>
              </div>
              <div className="flex items-center gap-1.5 bg-amber-50 px-2.5 py-1 rounded-full">
                <span className="text-amber-500"><Icons.Flame /></span>
                <span className="text-sm font-semibold text-amber-600">{streakCount} days</span>
              </div>
            </div>

            <div className="flex justify-between">
              {WEEK_DATA.map((dayData, idx) => (
                <div key={idx} className="flex flex-col items-center gap-1.5">
                  <span className={`text-xs font-medium ${dayData.isToday ? 'text-sage-600' : 'text-gray-400'}`}>
                    {dayData.day}
                  </span>
                  <div
                    className={`w-9 h-9 rounded-full flex items-center justify-center text-sm font-semibold ${
                      dayData.isToday
                        ? 'bg-sage-500 text-white ring-2 ring-sage-200 ring-offset-2'
                        : dayData.completed
                          ? 'bg-sage-100 text-sage-600'
                          : 'bg-gray-100 text-gray-400'
                    }`}
                  >
                    {dayData.completed && !dayData.isToday ? (
                      <span className="text-sage-500"><Icons.Check /></span>
                    ) : (
                      dayData.date
                    )}
                  </div>
                </div>
              ))}
            </div>
          </div>

          {/* Seasonal Tip */}
          <div className="mx-5 mb-4 bg-gradient-to-r from-amber-50 to-orange-50 rounded-2xl p-4 border border-amber-100">
            <div className="flex items-center gap-3">
              <div className="w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center text-amber-500">
                <Icons.Sun />
              </div>
              <div>
                <p className="font-medium text-gray-800 text-sm">Perfect walking weather</p>
                <p className="text-gray-500 text-xs">68Â°F and sunny until 4pm</p>
              </div>
            </div>
          </div>

          {/* Contextual Nudges */}
          {showStepsNudge && (
            <StepsNudge
              onAdd={handleAddWalk}
              onDismiss={() => setShowStepsNudge(false)}
            />
          )}

          {showLevelUp && (
            <LevelUpPrompt
              onAccept={handleLevelUp}
              onDismiss={() => setShowLevelUp(false)}
            />
          )}

          {showCheckIn && (
            <SoftCheckIn
              onKeep={() => setShowCheckIn(false)}
              onSwap={() => setShowCheckIn(false)}
              onDismiss={() => setShowCheckIn(false)}
            />
          )}

          {/* Unified Today's Plan */}
          <div className="mx-5 mb-5">
            <div className="flex items-center justify-between mb-3">
              <div className="flex items-center gap-2">
                <span className="text-sage-500"><Icons.Target /></span>
                <h2 className="font-semibold text-gray-800">Today's Plan</h2>
              </div>
              {myPlan.some(a => a.fromPlan) && (
                <span className="text-xs text-sage-600 bg-sage-50 px-2 py-1 rounded-full">
                  {myPlan.filter(a => a.fromPlan).length} from your plan
                </span>
              )}
            </div>

            {myPlan.length > 0 ? (
              <div className="bg-white rounded-2xl border border-gray-100 overflow-hidden">
                {myPlan.map((activity, idx) => {
                  const IconComponent = Icons[activity.icon];
                  const isCompleted = completedIds.has(activity.id);

                  return (
                    <div
                      key={activity.id}
                      className={`flex items-center gap-3 p-3 ${idx !== myPlan.length - 1 ? 'border-b border-gray-50' : ''} ${isCompleted ? 'bg-gray-50' : ''}`}
                    >
                      {/* Completion checkbox */}
                      <button
                        onClick={() => toggleComplete(activity.id)}
                        className={`w-6 h-6 rounded-full border-2 flex items-center justify-center flex-shrink-0 transition-all ${
                          isCompleted
                            ? 'bg-sage-500 border-sage-500'
                            : 'border-gray-300 hover:border-sage-400'
                        }`}
                      >
                        {isCompleted && (
                          <span className="text-white check-pop"><Icons.Check /></span>
                        )}
                      </button>

                      {/* Icon */}
                      <div className={`w-10 h-10 rounded-xl ${activity.bgColor} flex items-center justify-center ${isCompleted ? 'opacity-50' : ''}`}>
                        <IconComponent />
                      </div>

                      {/* Content */}
                      <div className={`flex-1 ${isCompleted ? 'opacity-50' : ''}`}>
                        <div className="flex items-center gap-2">
                          <p className={`font-medium text-sm ${isCompleted ? 'text-gray-400 line-through' : 'text-gray-800'}`}>
                            {activity.title}
                          </p>
                          {activity.fromPlan && !isCompleted && (
                            <span className="text-xs bg-sage-100 text-sage-600 px-1.5 py-0.5 rounded font-medium">
                              Plan
                            </span>
                          )}
                        </div>
                        <p className="text-xs text-gray-400">
                          {activity.time}
                          {activity.goalTag && !isCompleted && (
                            <span className="text-sage-500"> Â· {activity.goalTag}</span>
                          )}
                        </p>
                      </div>

                      {/* Remove button */}
                      <button
                        onClick={() => removeFromPlan(activity.id)}
                        className="w-6 h-6 rounded-full bg-gray-100 text-gray-400 flex items-center justify-center hover:bg-red-100 hover:text-red-500 transition-colors"
                      >
                        <Icons.X />
                      </button>
                    </div>
                  );
                })}
              </div>
            ) : (
              <div className="bg-white rounded-2xl border border-gray-100 p-6 text-center">
                <p className="text-gray-400 text-sm">Tap activities below to build your plan</p>
              </div>
            )}

            {/* Progress summary */}
            {myPlan.length > 0 && (
              <div className="flex items-center justify-between mt-3 px-1">
                <span className="text-xs text-gray-400">
                  {completedIds.size} of {myPlan.length} completed
                </span>
                <div className="flex-1 mx-3 h-1.5 bg-gray-100 rounded-full overflow-hidden">
                  <div
                    className="h-full bg-sage-500 rounded-full transition-all duration-300"
                    style={{ width: `${(completedIds.size / myPlan.length) * 100}%` }}
                  />
                </div>
              </div>
            )}
          </div>

          {/* Divider */}
          <div className="mx-5 mb-5">
            <div className="h-px bg-gradient-to-r from-transparent via-gray-200 to-transparent" />
          </div>

          {/* For You */}
          <div className="mb-6">
            <div className="flex items-center gap-2 mb-3 px-5">
              <span className="text-sage-500"><Icons.Sparkles /></span>
              <h3 className="font-semibold text-gray-800">For You</h3>
            </div>
            <div className="flex gap-3 px-5 overflow-x-auto hide-scrollbar">
              {BROWSE_ACTIVITIES.forYou.map(activity => {
                const IconComponent = Icons[activity.icon];
                const isInPlan = planItemIds.has(activity.id);

                return (
                  <button
                    key={activity.id}
                    onClick={() => addToPlan(activity)}
                    disabled={isInPlan}
                    className={`flex-shrink-0 w-36 h-32 rounded-2xl bg-gradient-to-br ${activity.gradient} p-3 text-left transition-all ${
                      isInPlan ? 'opacity-50' : 'active:scale-95'
                    }`}
                  >
                    <div className="flex items-center justify-between">
                      <div className="w-8 h-8 bg-white/20 rounded-xl flex items-center justify-center text-white">
                        <IconComponent />
                      </div>
                      {isInPlan && (
                        <span className="text-white/80 text-xs bg-white/20 px-2 py-0.5 rounded-full">Added</span>
                      )}
                    </div>
                    <p className="text-white font-medium text-sm mt-6">{activity.title}</p>
                    <p className="text-white/70 text-xs">{activity.time}</p>
                  </button>
                );
              })}
            </div>
          </div>

          {/* Movement */}
          <div className="mb-6">
            <div className="flex items-center gap-2 mb-3 px-5">
              <span className="text-amber-500"><Icons.Dumbbell /></span>
              <h3 className="font-semibold text-gray-800">Movement</h3>
            </div>
            <div className="flex gap-3 px-5 overflow-x-auto hide-scrollbar">
              {BROWSE_ACTIVITIES.movement.map(activity => {
                const IconComponent = Icons[activity.icon];
                const isInPlan = planItemIds.has(activity.id);

                return (
                  <button
                    key={activity.id}
                    onClick={() => addToPlan(activity)}
                    disabled={isInPlan}
                    className={`flex-shrink-0 w-36 h-32 rounded-2xl bg-gradient-to-br ${activity.gradient} p-3 text-left transition-all ${
                      isInPlan ? 'opacity-50' : 'active:scale-95'
                    }`}
                  >
                    <div className="flex items-center justify-between">
                      <div className="w-8 h-8 bg-white/20 rounded-xl flex items-center justify-center text-white">
                        <IconComponent />
                      </div>
                      {isInPlan && (
                        <span className="text-white/80 text-xs bg-white/20 px-2 py-0.5 rounded-full">Added</span>
                      )}
                    </div>
                    <p className="text-white font-medium text-sm mt-6">{activity.title}</p>
                    <p className="text-white/70 text-xs">{activity.time}</p>
                  </button>
                );
              })}
            </div>
          </div>

          {/* Challenges */}
          <div className="mb-6">
            <div className="flex items-center gap-2 mb-3 px-5">
              <span className="text-purple-500"><Icons.Trophy /></span>
              <h3 className="font-semibold text-gray-800">Challenges</h3>
            </div>
            <div className="flex gap-3 px-5 overflow-x-auto hide-scrollbar">
              {BROWSE_ACTIVITIES.challenges.map(challenge => {
                const IconComponent = Icons[challenge.icon];
                return (
                  <div
                    key={challenge.id}
                    className={`flex-shrink-0 w-48 rounded-2xl bg-gradient-to-br ${challenge.gradient} p-4 cursor-pointer active:scale-95 transition-transform`}
                  >
                    <div className="flex items-center gap-2 mb-2">
                      <span className="text-xs bg-white/20 text-white px-2 py-0.5 rounded-full">{challenge.duration}</span>
                    </div>
                    <p className="text-white font-semibold text-base mb-1">{challenge.title}</p>
                    <div className="w-full h-1.5 bg-white/20 rounded-full overflow-hidden mb-1">
                      <div
                        className="h-full bg-white rounded-full"
                        style={{ width: `${(challenge.progress / parseInt(challenge.duration)) * 100}%` }}
                      />
                    </div>
                    <p className="text-white/60 text-xs">
                      {challenge.progress > 0 ? `Day ${challenge.progress} of ${parseInt(challenge.duration)}` : 'Not started'}
                    </p>
                  </div>
                );
              })}
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
